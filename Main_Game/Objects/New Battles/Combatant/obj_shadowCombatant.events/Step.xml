<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event category="STEP" id="0">
  <actions>
    <action id="603" library="1">
      <!--action name: Code-->
      <kind>CODE</kind>
      <allowRelative>false</allowRelative>
      <question>false</question>
      <canApplyTo>true</canApplyTo>
      <actionType>CODE</actionType>
      <functionName/>
      <relative>false</relative>
      <not>false</not>
      <appliesTo>.self</appliesTo>
      <arguments>
        <argument kind="STRING">if (!attackSelected &amp;&amp; image_index == 4)
{
    attackType = irandom(1);
    attackSelected = true;
} else if (!attackSelected)
{
    image_index += 1;
}

if (descending == 1)
{
    if (image_index &gt; 0)
    {
        image_index -= (image_index &gt; 0);
    } else
    {
        descending = 0;
        INVUL = true;
        attackCompleted = true;
    }
}

if (attackType == 0)
{
    aD_x = 0;
    aD_y = 0;
    while (((aD_x == 0 &amp;&amp; aD_y == 0) || (aD_x != 0 &amp;&amp; aD_y != 0)) || (aD_x*64 + x &gt;= room_width) || (aD_x*64 + x &lt; 0) || (aD_y*64 + y &gt;= room_height) || (aD_y*64 + y &lt; 0))
    {
        aD_x = irandom(2)-1;
        aD_y = irandom(2)-1;
    }
    
    hspeed = aD_x*8;
    vspeed = aD_y*8;
    x += hspeed;
    y += vspeed;
    attackType = -1;
}

if (attackType == 1)
{
    aD_x = 0;
    aD_y = 0;
    while (aD_x == 0 &amp;&amp; aD_y == 0)
    {
        aD_x = irandom(2)-1;
        aD_y = irandom(2)-1;
    }
    
    projectile = instance_create(x+aD_x*64,y+aD_y*64,obj_shadowball);
    projectile.hspeed = aD_x*8;
    projectile.vspeed = aD_y*8;
    
    attackType = -1;
}

if (instance_number(obj_shadowball) == 0 &amp;&amp; attackType == -1 &amp;&amp; hspeed == 0 &amp;&amp; vspeed == 0 &amp;&amp; descending == 0)
{
    if (floor((obj_blockNetwork.blocks[x/64,y/64] mod 1000000)/1000) != 0)
    {
        descending = 1;
        image_index -= (image_index &gt; 0);
    } else
    {
        INVUL = false;
        attackCompleted = true;
    }
}

if (attackType == -1 &amp;&amp; (x mod 64 == 0) &amp;&amp; (y mod 64 == 0) &amp;&amp; (hspeed != 0 || vspeed != 0))
{
    hspeed = 0;
    vspeed = 0;
}

if (changeBack)
{
    attackSelected = false;
    attackCompleted = false;
    changeBack = false;
    attackType = 2;
    descending = 0;
    instance_change(obj_shadowIdle,false);
}
</argument>
      </arguments>
    </action>
  </actions>
</event>
